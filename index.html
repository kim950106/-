<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì „ë¶í‘¸ë“œì»¤ë„¥íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body { font-family: "Pretendard Variable", sans-serif; background-color: #F8F9FA; -webkit-tap-highlight-color: transparent; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="pb-28 text-gray-800 antialiased">

    <!-- í—¤ë” -->
    <header class="fixed top-0 w-full z-40 px-5 py-4 bg-white/90 backdrop-blur-md border-b border-gray-100 flex justify-between items-center">
        <h1 class="text-lg font-extrabold text-orange-600 cursor-pointer" onclick="location.reload()">ì „ë¶í‘¸ë“œì»¤ë„¥íŠ¸ ğŸšš</h1>
        <button onclick="openRegionModal()" class="flex items-center gap-1 text-[11px] bg-orange-50 text-orange-600 px-3 py-1.5 rounded-full font-bold border border-orange-100">
            <span id="currentRegion">ì „ë¶ ì „ì²´</span> â–¾
        </button>
    </header>

    <!-- 1. ë©”ì¸ í™”ë©´ (ê³ ê°) -->
    <main id="homeView" class="pt-20 animate-fade-in">
        <section class="px-5 mb-8">
            <div class="relative h-64 rounded-[2rem] overflow-hidden shadow-xl">
                <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=800" class="absolute inset-0 w-full h-full object-cover brightness-75">
                <div class="absolute bottom-6 left-6 text-white">
                    <span class="px-2 py-1 mb-2 text-[10px] font-bold bg-orange-600 rounded">ê³µì‹ íŒŒíŠ¸ë„ˆ</span>
                    <h2 class="text-2xl font-bold leading-tight">í–‰ì‚¬ì˜ í’ˆê²©,<br>ê²€ì¦ëœ í‘¸ë“œíŠ¸ëŸ­</h2>
                </div>
            </div>
        </section>

        <!-- íŠ¸ëŸ­ ë¦¬ìŠ¤íŠ¸ -->
        <section class="mb-10 px-5">
            <h3 class="text-lg font-bold mb-3 text-gray-900">ğŸšš ìš°ë¦¬ë™ë„¤ í‘¸ë“œíŠ¸ëŸ­</h3>
            <div id="truckList" class="grid grid-cols-2 gap-4">
                <div class="col-span-2 py-10 text-center text-xs text-gray-400">ë°ì´í„° ë¡œë”© ì¤‘...</div>
            </div>
        </section>

        <!-- í–‰ì‚¬ ë¬¸ì˜ -->
        <section class="px-5" id="inquirySection">
            <div class="bg-white p-6 rounded-3xl shadow-xl border border-gray-50">
                <h3 class="text-xl font-bold mb-1">ğŸ“ í–‰ì‚¬ë¬¸ì˜ ìš”ì²­</h3>
                <p class="text-xs text-gray-400 mb-4">ì§€ì—­ê³¼ íŠ¸ëŸ­ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
                
                <form id="quoteForm" class="space-y-3">
                    <input type="hidden" name="type" value="quote">
                    
                    <!-- ì§€ì—­/íŠ¸ëŸ­ ì„ íƒ -->
                    <div class="flex gap-2">
                        <select id="qRegion" class="w-1/3 bg-gray-50 p-3 rounded-xl text-sm border border-transparent outline-none" onchange="updateTruckSelect(this.value)">
                            <option value="ì „ì²´">ì§€ì—­ì„ íƒ</option>
                            <option value="ì „ì£¼">ì „ì£¼</option><option value="êµ°ì‚°">êµ°ì‚°</option><option value="ìµì‚°">ìµì‚°</option>
                            <option value="ì •ì">ì •ì</option><option value="ë‚¨ì›">ë‚¨ì›</option><option value="ê¹€ì œ">ê¹€ì œ</option>
                            <option value="ì™„ì£¼">ì™„ì£¼</option><option value="ì§„ì•ˆ">ì§„ì•ˆ</option><option value="ë¬´ì£¼">ë¬´ì£¼</option>
                            <option value="ì¥ìˆ˜">ì¥ìˆ˜</option><option value="ì„ì‹¤">ì„ì‹¤</option><option value="ìˆœì°½">ìˆœì°½</option>
                            <option value="ê³ ì°½">ê³ ì°½</option><option value="ë¶€ì•ˆ">ë¶€ì•ˆ</option>
                        </select>
                        <select name="selectedTruck" id="qTruck" class="w-2/3 bg-gray-50 p-3 rounded-xl text-sm border border-transparent outline-none">
                            <option value="ìƒê´€ì—†ìŒ">íŠ¸ëŸ­ ìƒê´€ì—†ìŒ (ì¶”ì²œ)</option>
                        </select>
                    </div>

                    <div class="flex gap-2">
                        <input type="text" name="name" placeholder="ì‹ ì²­ìëª…" required class="w-1/2 bg-gray-50 p-3 rounded-xl text-sm outline-none">
                        <input type="tel" name="phone" placeholder="ì—°ë½ì²˜" required class="w-1/2 bg-gray-50 p-3 rounded-xl text-sm outline-none">
                    </div>
                    <input type="email" name="clientEmail" placeholder="ì´ë©”ì¼ (ê³„ì•½ì„œ ìˆ˜ì‹ ìš©)" required class="w-full bg-gray-50 p-3 rounded-xl text-sm outline-none">
                    
                    <div class="flex gap-2">
                        <input type="date" name="date" required class="w-1/2 bg-gray-50 p-3 rounded-xl text-sm text-gray-500 outline-none">
                        <input type="text" name="budget" placeholder="ì˜ˆì‚°" class="w-1/2 bg-gray-50 p-3 rounded-xl text-sm outline-none">
                    </div>
                    <input type="text" name="location" placeholder="í–‰ì‚¬ ì¥ì†Œ ìƒì„¸" required class="w-full bg-gray-50 p-3 rounded-xl text-sm outline-none">
                    <textarea name="details" rows="2" placeholder="ìš”ì²­ì‚¬í•­" class="w-full bg-gray-50 p-3 rounded-xl text-sm outline-none"></textarea>
                    
                    <button type="submit" id="quoteBtn" class="w-full bg-orange-600 text-white py-4 rounded-xl font-bold shadow-lg active:scale-95 transition">í–‰ì‚¬ë¬¸ì˜ ë³´ë‚´ê¸°</button>
                </form>
            </div>
        </section>
    </main>

    <!-- 2. ë“±ë¡ ì‹ ì²­ (íŒŒíŠ¸ë„ˆ/ì¸ë ¥) -->
    <main id="partnerView" class="hidden pt-20 bg-gray-900 min-h-screen text-white pb-24 px-5">
        <h2 class="text-2xl font-bold mb-1 text-center">ë“±ë¡ ì‹ ì²­</h2>
        <p class="text-gray-400 text-xs mb-6 text-center">íŠ¸ëŸ­ ì…ì  ë° ìŠ¤íƒœí”„ ë“±ë¡</p>
        
        <form id="partnerForm" class="space-y-4 bg-gray-800 p-6 rounded-3xl border border-gray-700">
            <input type="hidden" name="type" value="partner">
            <div class="flex gap-2 p-1 bg-gray-900 rounded-xl border border-gray-600">
                <label class="flex-1 cursor-pointer">
                    <input type="radio" name="category" value="í‘¸ë“œíŠ¸ëŸ­" checked class="peer hidden" onchange="toggleForm('truck')">
                    <div class="py-3 text-center rounded-lg text-gray-400 peer-checked:bg-orange-600 peer-checked:text-white transition text-sm font-bold">ğŸšš íŠ¸ëŸ­ ì‚¬ì¥ë‹˜</div>
                </label>
                <label class="flex-1 cursor-pointer">
                    <input type="radio" name="category" value="ì¸ë ¥" class="peer hidden" onchange="toggleForm('staff')">
                    <div class="py-3 text-center rounded-lg text-gray-400 peer-checked:bg-blue-600 peer-checked:text-white transition text-sm font-bold">ğŸ§‘â€ğŸ³ í˜„ì¥ ìŠ¤íƒœí”„</div>
                </label>
            </div>

            <div class="space-y-3">
                <div id="fieldTruckOnly">
                    <input type="text" id="truckName" placeholder="ìƒí˜¸ëª…" class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none mb-3">
                    <input type="text" id="truckOwner" placeholder="ëŒ€í‘œìëª…" class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none mb-3">
                    <!-- ê¸°ë³¸ ê²¬ì  ì…ë ¥ -->
                    <input type="text" name="basicQuote" id="basicQuote" placeholder="ê¸°ë³¸ ê²¬ì  (ì˜ˆ: 100ì¸ë¶„ 80ë§Œì›ë¶€í„°)" class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                </div>
                <div id="fieldStaffOnly" class="hidden space-y-3">
                    <input type="text" id="staffName" placeholder="ì„±í•¨ (ë³¸ëª…)" class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                    <div class="flex gap-2">
                        <input type="number" id="staffAge" placeholder="ë‚˜ì´" class="w-1/3 bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                        <input type="text" id="staffDates" placeholder="ê°€ëŠ¥ì¼ (ì˜ˆ: ì£¼ë§)" class="w-2/3 bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                    </div>
                </div>
                <div class="flex gap-2">
                    <input type="tel" name="phone" placeholder="ì—°ë½ì²˜" required class="w-1/2 bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                    <input type="email" name="email" placeholder="ì´ë©”ì¼ (í•„ìˆ˜)" required class="w-1/2 bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                </div>
                <input type="text" name="region" placeholder="í™œë™ ì§€ì—­" required class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                <input type="text" name="menu" id="inputMenu" placeholder="ì£¼ìš” ë©”ë‰´" required class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none">
                <textarea name="desc" rows="3" placeholder="ì†Œê°œê¸€" class="w-full bg-gray-900 border border-gray-600 p-3 rounded-xl text-sm outline-none"></textarea>
            </div>

            <div class="space-y-2 pt-2 border-t border-gray-700">
                <label class="text-xs text-gray-400">í•„ìˆ˜ ì„œë¥˜/ì‚¬ì§„</label>
                <input type="file" id="img1" class="text-[10px] text-gray-500 w-full mb-1">
                <input type="file" id="fileBiz" class="text-[10px] text-gray-500 w-full mb-1">
                <input type="file" id="fileBank" class="text-[10px] text-gray-500 w-full mb-1">
                <input type="file" id="fileOther" class="text-[10px] text-gray-500 w-full">
            </div>

            <div class="bg-gray-700/50 p-3 rounded-xl border border-gray-600 flex items-center gap-2">
                <input type="checkbox" required class="w-4 h-4 text-orange-600">
                <span class="text-[10px] text-gray-300">(í•„ìˆ˜) ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì œ3ì ì œê³µ ë™ì˜</span>
            </div>

            <button type="submit" id="partnerBtn" class="w-full bg-white text-black py-4 rounded-xl font-bold mt-2 shadow-lg">ë“±ë¡ ì‹ ì²­í•˜ê¸°</button>
        </form>
    </main>

    <!-- íƒ­ë°” -->
    <nav class="fixed bottom-6 left-5 right-5 h-16 bg-white rounded-2xl shadow-2xl flex justify-between items-center px-4 z-40 border border-gray-100">
        <button onclick="switchTab('home')" id="tabHome" class="flex-1 flex flex-col items-center text-orange-600"><span class="text-xl">ğŸ </span><span class="text-[10px] font-bold">í™ˆ/ë¬¸ì˜</span></button>
        <div class="w-px h-6 bg-gray-200"></div>
        <button onclick="switchTab('partner')" id="tabPartner" class="flex-1 flex flex-col items-center text-gray-400"><span class="text-xl">ğŸ“</span><span class="text-[10px] font-bold">ë“±ë¡í•˜ê¸°</span></button>
    </nav>

    <!-- íŠ¸ëŸ­ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="detailModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeDetail()"></div>
        <div class="bg-white w-full max-w-sm rounded-3xl overflow-hidden relative z-10 shadow-2xl h-[70vh] flex flex-col">
            <div class="h-2/5 bg-gray-200 relative">
                <img id="modalImg" class="w-full h-full object-cover">
                <button onclick="closeDetail()" class="absolute top-4 right-4 bg-black/50 text-white p-2 rounded-full">âœ•</button>
            </div>
            <div class="p-6 overflow-y-auto flex-1 pb-24">
                <span id="detailBadge" class="text-[10px] font-bold px-2 py-1 rounded bg-orange-100 text-orange-600 mb-2 inline-block"></span>
                <h3 id="detailName" class="text-2xl font-bold text-gray-900 mb-1"></h3>
                <p id="detailRegion" class="text-xs text-gray-500 mb-4"></p>
                <div class="bg-gray-50 p-4 rounded-xl mb-4">
                    <h4 class="text-xs font-bold text-gray-400 mb-1">ë©”ë‰´</h4>
                    <p id="detailMenu" class="font-medium text-gray-800"></p>
                </div>
                <p id="detailDesc" class="text-sm text-gray-600 leading-relaxed whitespace-pre-wrap"></p>
                
                <!-- ê²¬ì  í‘œì‹œ -->
                <div id="quoteBox" class="hidden mt-4 bg-orange-50 p-4 rounded-xl border border-orange-100 animate-fade-in">
                    <h4 class="text-xs font-bold text-orange-600 mb-1">ğŸ’° ê¸°ë³¸ ê²¬ì </h4>
                    <p id="quoteText" class="text-sm font-bold text-gray-800"></p>
                </div>
            </div>
            <!-- í•˜ë‹¨ ê³ ì • ë²„íŠ¼ -->
            <div class="absolute bottom-0 w-full p-4 bg-white border-t border-gray-100">
                <button onclick="showQuote()" class="w-full bg-gray-900 text-white py-3 rounded-xl font-bold">ê²¬ì  ë³´ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì§€ì—­ ëª¨ë‹¬ -->
    <div id="regionModal" class="fixed inset-0 z-50 hidden bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center">
        <div class="bg-white w-full sm:w-96 rounded-t-3xl sm:rounded-3xl p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold">ì§€ì—­ ì„ íƒ</h3>
                <button onclick="document.getElementById('regionModal').classList.add('hidden')">âœ•</button>
            </div>
            <div class="grid grid-cols-4 gap-2 text-sm" id="regionGrid"></div>
        </div>
    </div>

    <script>
        const API_URL = "YOUR_GOOGLE_SCRIPT_URL_HERE"; // âš ï¸ URL êµì²´
        let allData = [], currentDetail = null;

        fetch(`${API_URL}?mode=client`).then(r=>r.json()).then(res => {
            allData = res.data;
            filterTrucks('ì „ì²´');
            updateTruckSelect('ì „ì²´');
        });

        function filterTrucks(region) {
            document.getElementById('currentRegion').innerText = region==='ì „ì²´'?'ì „ë¶ ì „ì²´':region;
            const trucks = allData.filter(d => d.category === 'í‘¸ë“œíŠ¸ëŸ­' && (region==='ì „ì²´' || d.region.includes(region)));
            document.getElementById('truckList').innerHTML = trucks.length ? trucks.map(t => `
                <div onclick='openDetail(${JSON.stringify(t)})' class="cursor-pointer bg-white rounded-xl overflow-hidden shadow-sm border border-gray-100">
                    <div class="h-32 bg-gray-200"><img src="${t.mainImg}" class="w-full h-full object-cover"></div>
                    <div class="p-3">
                        <span class="text-[10px] text-orange-500 font-bold">${t.region}</span>
                        <h4 class="font-bold text-sm truncate">${t.name}</h4>
                        <p class="text-xs text-gray-400 truncate">${t.menu}</p>
                    </div>
                </div>`).join('') : '<div class="col-span-2 py-10 text-center text-xs text-gray-400">ë°ì´í„° ì—†ìŒ</div>';
        }

        function updateTruckSelect(region) {
            const select = document.getElementById('qTruck');
            select.innerHTML = '<option value="ìƒê´€ì—†ìŒ">íŠ¸ëŸ­ ìƒê´€ì—†ìŒ (ì¶”ì²œ)</option>';
            allData.filter(d => d.category === 'í‘¸ë“œíŠ¸ëŸ­' && (region==='ì „ì²´' || d.region.includes(region)))
                   .forEach(t => {
                       const opt = document.createElement('option');
                       opt.value = t.name; opt.innerText = t.name;
                       select.appendChild(opt);
                   });
        }

        function openDetail(d) {
            currentDetail = d;
            document.getElementById('modalImg').src = d.mainImg;
            document.getElementById('detailName').innerText = d.name;
            document.getElementById('detailRegion').innerText = d.region;
            document.getElementById('detailMenu').innerText = d.menu;
            document.getElementById('detailDesc').innerText = d.desc;
            document.getElementById('detailBadge').innerText = d.category;
            document.getElementById('quoteBox').classList.add('hidden');
            document.getElementById('detailModal').classList.remove('hidden');
        }

        function showQuote() {
            const box = document.getElementById('quoteBox');
            const txt = document.getElementById('quoteText');
            txt.innerText = (currentDetail.basicQuote && currentDetail.basicQuote.trim()) ? currentDetail.basicQuote : "í–‰ì‚¬ë¬¸ì˜ í•˜ì‹œë©´ ë³„ë„ë¡œ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.";
            box.classList.remove('hidden');
            box.scrollIntoView({behavior:'smooth'});
        }
        function closeDetail() { document.getElementById('detailModal').classList.add('hidden'); }

        // í¼ ì „ì†¡
        document.getElementById('quoteForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('quoteBtn'); btn.innerText="ì „ì†¡ ì¤‘..."; btn.disabled=true;
            const p = Object.fromEntries(new FormData(e.target).entries());
            fetch(API_URL, {method:'POST', body:JSON.stringify(p)}).then(r=>r.json()).then(res=>{alert(res.msg); e.target.reset();}).finally(()=>{btn.innerText="í–‰ì‚¬ë¬¸ì˜ ë³´ë‚´ê¸°"; btn.disabled=false;});
        };
        document.getElementById('partnerForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('partnerBtn'); btn.innerText="ì „ì†¡ ì¤‘..."; btn.disabled=true;
            const fd = new FormData(e.target);
            let p = Object.fromEntries(fd.entries());
            if(p.category==='ì¸ë ¥'){p.name=document.getElementById('staffName').value; p.owner=document.getElementById('staffAge').value+'ì„¸'; p.age=document.getElementById('staffAge').value; p.dates=document.getElementById('staffDates').value;}
            else{p.name=document.getElementById('truckName').value; p.owner=document.getElementById('truckOwner').value; p.basicQuote=document.getElementById('basicQuote').value;}
            
            p.fileBiz=await toBase64(document.getElementById('fileBiz').files[0]);
            p.fileBank=await toBase64(document.getElementById('fileBank').files[0]);
            p.fileOther=await toBase64(document.getElementById('fileOther').files[0]);
            p.img1=await toBase64(document.getElementById('img1').files[0]);

            fetch(API_URL, {method:'POST', body:JSON.stringify(p)}).then(r=>r.json()).then(res=>{alert(res.msg); if(res.status==='success')location.reload();}).finally(()=>{btn.innerText="ë“±ë¡ ì‹ ì²­í•˜ê¸°"; btn.disabled=false;});
        };

        // ê¸°íƒ€ UI í•¨ìˆ˜
        const regions = ['ì „ì²´','ì „ì£¼','êµ°ì‚°','ìµì‚°','ì •ì','ë‚¨ì›','ê¹€ì œ','ì™„ì£¼','ì§„ì•ˆ','ë¬´ì£¼','ì¥ìˆ˜','ì„ì‹¤','ìˆœì°½','ê³ ì°½','ë¶€ì•ˆ'];
        document.getElementById('regionGrid').innerHTML = regions.map(r => `<button onclick="filterTrucks('${r}');document.getElementById('regionModal').classList.add('hidden')" class="p-3 bg-gray-100 rounded-xl hover:bg-orange-100 hover:text-orange-600 font-bold">${r}</button>`).join('');
        function openRegionModal(){ document.getElementById('regionModal').classList.remove('hidden'); }
        function switchTab(t) {
            ['home','partner'].forEach(x=>document.getElementById(x+'View').classList.add('hidden'));
            document.getElementById(t+'View').classList.remove('hidden');
            document.getElementById('tabHome').className = "flex-1 flex flex-col items-center " + (t==='home'?'text-orange-600':'text-gray-400');
            document.getElementById('tabPartner').className = "flex-1 flex flex-col items-center " + (t==='partner'?'text-white':'text-gray-400');
            document.body.style.backgroundColor = t==='partner'?'#111827':'#F8F9FA';
            window.scrollTo(0,0);
        }
        function toggleForm(type) {
            const isS = type==='staff';
            document.getElementById('fieldTruckOnly').classList.toggle('hidden', isS);
            document.getElementById('fieldStaffOnly').classList.toggle('hidden', !isS);
            document.getElementById('divBiz').classList.toggle('hidden', isS); // ì‚¬ì—…ìì¦
            document.getElementById('truckName').required = !isS;
            document.getElementById('staffName').required = isS;
        }
        const toBase64 = file => new Promise(r => { if(!file)r(''); else {const rx=new FileReader(); rx.onload=e=>r(e.target.result); rx.readAsDataURL(file);} });
    </script>
</body>
</html>
